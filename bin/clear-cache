#!/bin/zsh

# Function to check if a command exists
function check-command() {
	command -v "$1" >/dev/null 2>&1
}

function log() {
	echo '[clear-cache]' "$1" >&2
}

function clear-cache {
	# pip
	if check-command pip; then
		log "Clearing pip cache..."
		pip cache purge
	fi
	# ruff
	if check-command uvx; then
		log "Clearing ruff cache..."
		uvx ruff clean
	fi
	# uv
	if check-command uv; then
		log "Clearing uv cache..."
		uv cache clean
	fi
	# npm
	if check-command npm; then
		log "Clearing npm cache..."
		npm cache clean --force
	fi
	# pnpm
	if check-command pnpm; then
		log "Clearing pnpm cache..."
		pnpm store prune
	fi
	# pre-commit
	if check-command pre-commit; then
		log "Clearing pre-commit cache..."
		pre-commit gc
	fi
	# Docker
	if check-command docker; then
		log "Clearing Docker cache..."
		docker system prune -f --volumes
	fi
}
